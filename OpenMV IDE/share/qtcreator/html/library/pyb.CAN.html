

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>class CAN – controller area network communication bus &mdash; MicroPython 1.9.4 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/customstyle.css" type="text/css" />
  

  
    <link rel="top" title="MicroPython 1.9.4 documentation" href="../index.html"/>
        <link rel="up" title="MicroPython libraries" href="index.html"/>
        <link rel="next" title="class DAC – digital to analog conversion" href="pyb.DAC.html"/>
        <link rel="prev" title="class ADC – analog to digital conversion" href="pyb.ADC.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> MicroPython
          

          
            
            <img src="../_static/web-logo-sticky.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1.9.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../openmvcam/quickref.html">Quick reference for the openmvcam</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openmvcam/general.html">General information about the openmvcam</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openmvcam/tutorial/index.html">OpenMV Cam Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">MicroPython libraries</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#python-standard-libraries-and-micro-libraries">Python standard libraries and micro-libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#micropython-specific-libraries">MicroPython-specific libraries</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#libraries-specific-to-the-openmv-cam">Libraries specific to the OpenMV Cam</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="pyb.html"><code class="docutils literal"><span class="pre">pyb</span></code> &#8212; functions related to the board</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="pyb.html#time-related-functions">Time related functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyb.html#reset-related-functions">Reset related functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyb.html#interrupt-related-functions">Interrupt related functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyb.html#power-related-functions">Power related functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyb.html#miscellaneous-functions">Miscellaneous functions</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="pyb.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyb.ADC.html">class ADC &#8211; analog to digital conversion</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="">class CAN &#8211; controller area network communication bus</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#constructors">Constructors</a></li>
<li class="toctree-l4"><a class="reference internal" href="#class-methods">Class Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="#constants">Constants</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyb.DAC.html">class DAC &#8211; digital to analog conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyb.ExtInt.html">class ExtInt &#8211; configure I/O pins to interrupt on external events</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyb.I2C.html">class I2C &#8211; a two-wire serial protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyb.LED.html">class LED &#8211; LED object</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyb.Pin.html">class Pin &#8211; control I/O pins</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyb.Pin.html#class-pinaf-pin-alternate-functions">class PinAF &#8211; Pin Alternate Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyb.RTC.html">class RTC &#8211; real time clock</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyb.Servo.html">class Servo &#8211; 3-wire hobby servo driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyb.SPI.html">class SPI &#8211; a master-driven serial protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyb.Timer.html">class Timer &#8211; control internal timers</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyb.Timer.html#class-timerchannel-setup-a-channel-for-a-timer">class TimerChannel &#8212; setup a channel for a timer</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyb.UART.html">class UART &#8211; duplex serial communication bus</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyb.USB_VCP.html">class USB_VCP &#8211; USB virtual comm port</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.time.html"><code class="docutils literal"><span class="pre">time</span></code> &#8212; tracking elapsed time</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.sensor.html"><code class="docutils literal"><span class="pre">sensor</span></code> &#8212; camera sensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.image.html"><code class="docutils literal"><span class="pre">image</span></code> &#8212; machine vision</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.image.html#class-haarcascade-feature-descriptor">class HaarCascade &#8211; Feature Descriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.image.html#class-similarity-similarity-object">class Similarity &#8211; Similarity Object</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.image.html#class-histogram-histogram-object">class Histogram &#8211; Histogram Object</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.image.html#class-percentile-percentile-object">class Percentile &#8211; Percentile Object</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.image.html#class-threshold-threshold-object">class Threshold &#8211; Threshold Object</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.image.html#class-statistics-statistics-object">class Statistics &#8211; Statistics Object</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.image.html#class-blob-blob-object">class Blob &#8211; Blob object</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.image.html#class-line-line-object">class Line &#8211; Line object</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.image.html#class-circle-circle-object">class Circle &#8211; Circle object</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.image.html#class-rect-rectangle-object">class Rect &#8211; Rectangle Object</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.image.html#class-qrcode-qrcode-object">class QRCode &#8211; QRCode object</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.image.html#class-apriltag-apriltag-object">class AprilTag &#8211; AprilTag object</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.image.html#class-datamatrix-datamatrix-object">class DataMatrix &#8211; DataMatrix object</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.image.html#class-barcode-barcode-object">class BarCode &#8211; BarCode object</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.image.html#class-displacement-displacement-object">class Displacement &#8211; Displacement object</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.image.html#class-kptmatch-keypoint-object">class kptmatch &#8211; Keypoint Object</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.image.html#class-imagewriter-imagewriter-object">class ImageWriter &#8211; ImageWriter object</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.image.html#class-imagereader-imagereader-object">class ImageReader &#8211; ImageReader object</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.image.html#class-image-image-object">class Image &#8211; Image object</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.nn.html"><code class="docutils literal"><span class="pre">nn</span></code> &#8212; neural networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.nn.html#class-nn-class-nn-dection-result">class nn_class &#8211; nn dection result</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.nn.html#class-net-neural-network">class Net &#8211; Neural Network</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.gif.html"><code class="docutils literal"><span class="pre">gif</span></code> &#8212; gif recording</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.gif.html#class-gif-gif-recorder">class Gif &#8211; Gif recorder</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.mjpeg.html"><code class="docutils literal"><span class="pre">mjpeg</span></code> &#8212; mjpeg recording</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.mjpeg.html#class-mjpeg-mjpeg-recorder">class Mjpeg &#8211; Mjpeg recorder</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.lcd.html"><code class="docutils literal"><span class="pre">lcd</span></code> &#8212; lcd shield driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.fir.html"><code class="docutils literal"><span class="pre">fir</span></code> &#8212; thermopile shield driver (fir == far infrared)</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.tv.html"><code class="docutils literal"><span class="pre">tv</span></code> &#8212; tv shield driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.cpufreq.html"><code class="docutils literal"><span class="pre">cpufreq</span></code> &#8212; CPU Frequency Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.omv.html"><code class="docutils literal"><span class="pre">omv</span></code> &#8212; OpenMV Cam Information</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">The MicroPython language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genrst/index.html">MicroPython differences from CPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">MicroPython license information</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">MicroPython</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">MicroPython libraries</a> &raquo;</li>
      
    <li>class CAN &#8211; controller area network communication bus</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/library/pyb.CAN.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="class-can-controller-area-network-communication-bus">
<span id="pyb-can"></span><h1>class CAN &#8211; controller area network communication bus<a class="headerlink" href="#class-can-controller-area-network-communication-bus" title="Permalink to this headline">¶</a></h1>
<p>CAN implements the standard CAN communications protocol.  At
the physical level it consists of 2 lines: RX and TX.  Note that
to connect the pyboard to a CAN bus you must use a CAN transceiver
to convert the CAN logic signals from the pyboard to the correct
voltage levels on the bus.</p>
<p>Example usage (works without anything connected):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pyb</span> <span class="kn">import</span> <span class="n">CAN</span>
<span class="n">can</span> <span class="o">=</span> <span class="n">CAN</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">CAN</span><span class="o">.</span><span class="n">LOOPBACK</span><span class="p">)</span>
<span class="n">can</span><span class="o">.</span><span class="n">setfilter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">CAN</span><span class="o">.</span><span class="n">LIST16</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">123</span><span class="p">,</span> <span class="mi">124</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">126</span><span class="p">))</span>  <span class="c"># set a filter to receive messages with id=123, 124, 125 and 126</span>
<span class="n">can</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">&#39;message!&#39;</span><span class="p">,</span> <span class="mi">123</span><span class="p">)</span>   <span class="c"># send a message with id 123</span>
<span class="n">can</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>                 <span class="c"># receive message on FIFO 0</span>
</pre></div>
</div>
<div class="section" id="constructors">
<h2>Constructors<a class="headerlink" href="#constructors" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyb.pyb.CAN">
<em class="property">class </em><code class="descclassname">pyb.</code><code class="descname">CAN</code><span class="sig-paren">(</span><em>bus</em>, <em>...</em><span class="sig-paren">)</span><a class="headerlink" href="#pyb.pyb.CAN" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a CAN object on the given bus.  <em>bus</em> can be 2.
With no additional parameters, the CAN object is created but not
initialised (it has the settings from the last initialisation of
the bus, if any).  If extra arguments are given, the bus is initialised.
See <a class="reference internal" href="#pyb.CAN.init" title="pyb.CAN.init"><code class="xref py py-meth docutils literal"><span class="pre">CAN.init()</span></code></a> for parameters of initialisation.</p>
<p>The physical pins of the CAN bus are:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">CAN(2):</span> <span class="pre">``(RX,</span> <span class="pre">TX)</span> <span class="pre">=</span> <span class="pre">(PB12,</span> <span class="pre">PB13)</span></code></li>
</ul>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="class-methods">
<h2>Class Methods<a class="headerlink" href="#class-methods" title="Permalink to this headline">¶</a></h2>
<dl class="classmethod">
<dt id="pyb.CAN.initfilterbanks">
<em class="property">classmethod </em><code class="descclassname">CAN.</code><code class="descname">initfilterbanks</code><span class="sig-paren">(</span><em>nr</em><span class="sig-paren">)</span><a class="headerlink" href="#pyb.CAN.initfilterbanks" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign <code class="docutils literal"><span class="pre">28</span> <span class="pre">-</span> <span class="pre">nr</span></code> filter banks to CAN(2).</p>
</dd></dl>

</div>
<div class="section" id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h2>
<dl class="method">
<dt id="pyb.CAN.init">
<code class="descclassname">CAN.</code><code class="descname">init</code><span class="sig-paren">(</span><em>mode</em>, <em>extframe=False</em>, <em>prescaler=100</em>, <em>*</em>, <em>sjw=1</em>, <em>bs1=6</em>, <em>bs2=8</em>, <em>auto_restart=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pyb.CAN.init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise the CAN bus with the given parameters:</p>
<blockquote>
<div><ul class="simple">
<li><em>mode</em> is one of:  NORMAL, LOOPBACK, SILENT, SILENT_LOOPBACK</li>
<li>if <em>extframe</em> is True then the bus uses extended identifiers in the frames
(29 bits); otherwise it uses standard 11 bit identifiers</li>
<li><em>prescaler</em> is used to set the duration of 1 time quanta; the time quanta
will be the input clock (PCLK1, see <code class="xref py py-meth docutils literal"><span class="pre">pyb.freq()</span></code>) divided by the prescaler</li>
<li><em>sjw</em> is the resynchronisation jump width in units of the time quanta;
it can be 1, 2, 3, 4</li>
<li><em>bs1</em> defines the location of the sample point in units of the time quanta;
it can be between 1 and 1024 inclusive</li>
<li><em>bs2</em> defines the location of the transmit point in units of the time quanta;
it can be between 1 and 16 inclusive</li>
<li><em>auto_restart</em> sets whether the controller will automatically try and restart
communications after entering the bus-off state; if this is disabled then
<a class="reference internal" href="#pyb.CAN.restart" title="pyb.CAN.restart"><code class="xref py py-meth docutils literal"><span class="pre">restart()</span></code></a> can be used to leave the bus-off state</li>
</ul>
</div></blockquote>
<p>The time quanta tq is the basic unit of time for the CAN bus.  tq is the CAN
prescaler value divided by PCLK1 (the frequency of internal peripheral bus 1);
see <code class="xref py py-meth docutils literal"><span class="pre">pyb.freq()</span></code> to determine PCLK1.</p>
<p>A single bit is made up of the synchronisation segment, which is always 1 tq.
Then follows bit segment 1, then bit segment 2.  The sample point is after bit
segment 1 finishes.  The transmit point is after bit segment 2 finishes.
The baud rate will be 1/bittime, where the bittime is 1 + BS1 + BS2 multiplied
by the time quanta tq.</p>
<p>For example, with PCLK1=42MHz, prescaler=100, sjw=1, bs1=6, bs2=8, the value of
tq is 2.38 microseconds.  The bittime is 35.7 microseconds, and the baudrate
is 28kHz.</p>
<p>See page 680 of the STM32F405 datasheet for more details.</p>
</dd></dl>

<dl class="method">
<dt id="pyb.CAN.deinit">
<code class="descclassname">CAN.</code><code class="descname">deinit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyb.CAN.deinit" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn off the CAN bus.</p>
</dd></dl>

<dl class="method">
<dt id="pyb.CAN.restart">
<code class="descclassname">CAN.</code><code class="descname">restart</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyb.CAN.restart" title="Permalink to this definition">¶</a></dt>
<dd><p>Force a software restart of the CAN controller without resetting its
configuration.</p>
<p>If the controller enters the bus-off state then it will no longer participate
in bus activity.  If the controller is not configured to automatically restart
(see <a class="reference internal" href="#pyb.CAN.init" title="pyb.CAN.init"><code class="xref py py-meth docutils literal"><span class="pre">init()</span></code></a>) then this method can be used to trigger a restart,
and the controller will follow the CAN protocol to leave the bus-off state and
go into the error active state.</p>
</dd></dl>

<dl class="method">
<dt id="pyb.CAN.state">
<code class="descclassname">CAN.</code><code class="descname">state</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyb.CAN.state" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the state of the controller.  The return value can be one of:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">CAN.STOPPED</span></code> &#8211; the controller is completely off and reset;</li>
<li><code class="docutils literal"><span class="pre">CAN.ERROR_ACTIVE</span></code> &#8211; the controller is on and in the Error Active state
(both TEC and REC are less than 96);</li>
<li><code class="docutils literal"><span class="pre">CAN.ERROR_WARNING</span></code> &#8211; the controller is on and in the Error Warning state
(at least one of TEC or REC is 96 or greater);</li>
<li><code class="docutils literal"><span class="pre">CAN.ERROR_PASSIVE</span></code> &#8211; the controller is on and in the Error Passive state
(at least one of TEC or REC is 128 or greater);</li>
<li><code class="docutils literal"><span class="pre">CAN.BUS_OFF</span></code> &#8211; the controller is on but not participating in bus activity
(TEC overflowed beyond 255).</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="pyb.CAN.info">
<code class="descclassname">CAN.</code><code class="descname">info</code><span class="sig-paren">(</span><span class="optional">[</span><em>list</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pyb.CAN.info" title="Permalink to this definition">¶</a></dt>
<dd><p>Get information about the controller&#8217;s error states and TX and RX buffers.
If <em>list</em> is provided then it should be a list object with at least 8 entries,
which will be filled in with the information.  Otherwise a new list will be
created and filled in.  In both cases the return value of the method is the
populated list.</p>
<p>The values in the list are:</p>
<ul class="simple">
<li>TEC value</li>
<li>REC value</li>
<li>number of times the controller enterted the Error Warning state (wrapped
around to 0 after 65535)</li>
<li>number of times the controller enterted the Error Passive state (wrapped
around to 0 after 65535)</li>
<li>number of times the controller enterted the Bus Off state (wrapped
around to 0 after 65535)</li>
<li>number of pending TX messages</li>
<li>number of pending RX messages on fifo 0</li>
<li>number of pending RX messages on fifo 1</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="pyb.CAN.setfilter">
<code class="descclassname">CAN.</code><code class="descname">setfilter</code><span class="sig-paren">(</span><em>bank</em>, <em>mode</em>, <em>fifo</em>, <em>params</em>, <em>*</em>, <em>rtr</em><span class="sig-paren">)</span><a class="headerlink" href="#pyb.CAN.setfilter" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure a filter bank:</p>
<ul class="simple">
<li><em>bank</em> is the filter bank that is to be configured.</li>
<li><em>mode</em> is the mode the filter should operate in.</li>
<li><em>fifo</em> is which fifo (0 or 1) a message should be stored in, if it is accepted by this filter.</li>
<li><em>params</em> is an array of values the defines the filter. The contents of the array depends on the <em>mode</em> argument.</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="84%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><em>mode</em></th>
<th class="head">contents of <em>params</em> array</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>CAN.LIST16</td>
<td>Four 16 bit ids that will be accepted</td>
</tr>
<tr class="row-odd"><td>CAN.LIST32</td>
<td>Two 32 bit ids that will be accepted</td>
</tr>
<tr class="row-even"><td>CAN.MASK16</td>
<td><dl class="first last docutils">
<dt>Two 16 bit id/mask pairs. E.g. (1, 3, 4, 4)</dt>
<dd><div class="first last line-block">
<div class="line">The first pair, 1 and 3 will accept all ids</div>
<div class="line">that have bit 0 = 1 and bit 1 = 0.</div>
<div class="line">The second pair, 4 and 4, will accept all ids</div>
<div class="line">that have bit 2 = 1.</div>
</div>
</dd>
</dl>
</td>
</tr>
<tr class="row-odd"><td>CAN.MASK32</td>
<td>As with CAN.MASK16 but with only one 32 bit id/mask pair.</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><em>rtr</em> is an array of booleans that states if a filter should accept a
remote transmission request message.  If this argument is not given
then it defaults to <code class="docutils literal"><span class="pre">False</span></code> for all entries.  The length of the array
depends on the <em>mode</em> argument.</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><em>mode</em></th>
<th class="head">length of <em>rtr</em> array</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>CAN.LIST16</td>
<td>4</td>
</tr>
<tr class="row-odd"><td>CAN.LIST32</td>
<td>2</td>
</tr>
<tr class="row-even"><td>CAN.MASK16</td>
<td>2</td>
</tr>
<tr class="row-odd"><td>CAN.MASK32</td>
<td>1</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyb.CAN.clearfilter">
<code class="descclassname">CAN.</code><code class="descname">clearfilter</code><span class="sig-paren">(</span><em>bank</em><span class="sig-paren">)</span><a class="headerlink" href="#pyb.CAN.clearfilter" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear and disables a filter bank:</p>
<ul class="simple">
<li><em>bank</em> is the filter bank that is to be cleared.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="pyb.CAN.any">
<code class="descclassname">CAN.</code><code class="descname">any</code><span class="sig-paren">(</span><em>fifo</em><span class="sig-paren">)</span><a class="headerlink" href="#pyb.CAN.any" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal"><span class="pre">True</span></code> if any message waiting on the FIFO, else <code class="docutils literal"><span class="pre">False</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="pyb.CAN.recv">
<code class="descclassname">CAN.</code><code class="descname">recv</code><span class="sig-paren">(</span><em>fifo</em>, <em>list=None</em>, <em>*</em>, <em>timeout=5000</em><span class="sig-paren">)</span><a class="headerlink" href="#pyb.CAN.recv" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive data on the bus:</p>
<blockquote>
<div><ul class="simple">
<li><em>fifo</em> is an integer, which is the FIFO to receive on</li>
<li><em>list</em> is an optional list object to be used as the return value</li>
<li><em>timeout</em> is the timeout in milliseconds to wait for the receive.</li>
</ul>
</div></blockquote>
<p>Return value: A tuple containing four values.</p>
<blockquote>
<div><ul class="simple">
<li>The id of the message.</li>
<li>A boolean that indicates if the message is an RTR message.</li>
<li>The FMI (Filter Match Index) value.</li>
<li>An array containing the data.</li>
</ul>
</div></blockquote>
<p>If <em>list</em> is <code class="docutils literal"><span class="pre">None</span></code> then a new tuple will be allocated, as well as a new
bytes object to contain the data (as the fourth element in the tuple).</p>
<p>If <em>list</em> is not <code class="docutils literal"><span class="pre">None</span></code> then it should be a list object with a least four
elements.  The fourth element should be a memoryview object which is created
from either a bytearray or an array of type &#8216;B&#8217; or &#8216;b&#8217;, and this array must
have enough room for at least 8 bytes.  The list object will then be
populated with the first three return values above, and the memoryview object
will be resized inplace to the size of the data and filled in with that data.
The same list and memoryview objects can be reused in subsequent calls to
this method, providing a way of receiving data without using the heap.
For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">buf</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">memoryview</span><span class="p">(</span><span class="n">buf</span><span class="p">)]</span>
<span class="c"># No heap memory is allocated in the following call</span>
<span class="n">can</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">lst</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyb.CAN.send">
<code class="descclassname">CAN.</code><code class="descname">send</code><span class="sig-paren">(</span><em>data</em>, <em>id</em>, <em>*</em>, <em>timeout=0</em>, <em>rtr=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pyb.CAN.send" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a message on the bus:</p>
<blockquote>
<div><ul class="simple">
<li><em>data</em> is the data to send (an integer to send, or a buffer object).</li>
<li><em>id</em> is the id of the message to be sent.</li>
<li><em>timeout</em> is the timeout in milliseconds to wait for the send.</li>
<li><em>rtr</em> is a boolean that specifies if the message shall be sent as
a remote transmission request.  If <em>rtr</em> is True then only the length
of <em>data</em> is used to fill in the DLC slot of the frame; the actual
bytes in <em>data</em> are unused.</li>
</ul>
<p>If timeout is 0 the message is placed in a buffer in one of three hardware
buffers and the method returns immediately. If all three buffers are in use
an exception is thrown. If timeout is not 0, the method waits until the
message is transmitted. If the message can&#8217;t be transmitted within the
specified time an exception is thrown.</p>
</div></blockquote>
<p>Return value: <code class="docutils literal"><span class="pre">None</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="pyb.CAN.rxcallback">
<code class="descclassname">CAN.</code><code class="descname">rxcallback</code><span class="sig-paren">(</span><em>fifo</em>, <em>fun</em><span class="sig-paren">)</span><a class="headerlink" href="#pyb.CAN.rxcallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Register a function to be called when a message is accepted into a empty fifo:</p>
<ul class="simple">
<li><em>fifo</em> is the receiving fifo.</li>
<li><em>fun</em> is the function to be called when the fifo becomes non empty.</li>
</ul>
<p>The callback function takes two arguments the first is the can object it self the second is
a integer that indicates the reason for the callback.</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Reason</th>
<th class="head">&nbsp;</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>A message has been accepted into a empty FIFO.</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>The FIFO is full</td>
</tr>
<tr class="row-even"><td>2</td>
<td>A message has been lost due to a full FIFO</td>
</tr>
</tbody>
</table>
<p>Example use of rxcallback:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">cb0</span><span class="p">(</span><span class="n">bus</span><span class="p">,</span> <span class="n">reason</span><span class="p">):</span>
  <span class="k">print</span><span class="p">(</span><span class="s">&#39;cb0&#39;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">reason</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">print</span><span class="p">(</span><span class="s">&#39;pending&#39;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">reason</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
      <span class="k">print</span><span class="p">(</span><span class="s">&#39;full&#39;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">reason</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
      <span class="k">print</span><span class="p">(</span><span class="s">&#39;overflow&#39;</span><span class="p">)</span>

<span class="n">can</span> <span class="o">=</span> <span class="n">CAN</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">CAN</span><span class="o">.</span><span class="n">LOOPBACK</span><span class="p">)</span>
<span class="n">can</span><span class="o">.</span><span class="n">rxcallback</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">cb0</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="constants">
<h2>Constants<a class="headerlink" href="#constants" title="Permalink to this headline">¶</a></h2>
<dl class="data">
<dt id="pyb.CAN.NORMAL">
<code class="descclassname">CAN.</code><code class="descname">NORMAL</code><a class="headerlink" href="#pyb.CAN.NORMAL" title="Permalink to this definition">¶</a></dt>
<dt id="pyb.CAN.LOOPBACK">
<code class="descclassname">CAN.</code><code class="descname">LOOPBACK</code><a class="headerlink" href="#pyb.CAN.LOOPBACK" title="Permalink to this definition">¶</a></dt>
<dt id="pyb.CAN.SILENT">
<code class="descclassname">CAN.</code><code class="descname">SILENT</code><a class="headerlink" href="#pyb.CAN.SILENT" title="Permalink to this definition">¶</a></dt>
<dt id="pyb.CAN.SILENT_LOOPBACK">
<code class="descclassname">CAN.</code><code class="descname">SILENT_LOOPBACK</code><a class="headerlink" href="#pyb.CAN.SILENT_LOOPBACK" title="Permalink to this definition">¶</a></dt>
<dd><p>The mode of the CAN bus used in <a class="reference internal" href="#pyb.CAN.init" title="pyb.CAN.init"><code class="xref py py-meth docutils literal"><span class="pre">init()</span></code></a>.</p>
</dd></dl>

<dl class="data">
<dt id="pyb.CAN.STOPPED">
<code class="descclassname">CAN.</code><code class="descname">STOPPED</code><a class="headerlink" href="#pyb.CAN.STOPPED" title="Permalink to this definition">¶</a></dt>
<dt id="pyb.CAN.ERROR_ACTIVE">
<code class="descclassname">CAN.</code><code class="descname">ERROR_ACTIVE</code><a class="headerlink" href="#pyb.CAN.ERROR_ACTIVE" title="Permalink to this definition">¶</a></dt>
<dt id="pyb.CAN.ERROR_WARNING">
<code class="descclassname">CAN.</code><code class="descname">ERROR_WARNING</code><a class="headerlink" href="#pyb.CAN.ERROR_WARNING" title="Permalink to this definition">¶</a></dt>
<dt id="pyb.CAN.ERROR_PASSIVE">
<code class="descclassname">CAN.</code><code class="descname">ERROR_PASSIVE</code><a class="headerlink" href="#pyb.CAN.ERROR_PASSIVE" title="Permalink to this definition">¶</a></dt>
<dt id="pyb.CAN.BUS_OFF">
<code class="descclassname">CAN.</code><code class="descname">BUS_OFF</code><a class="headerlink" href="#pyb.CAN.BUS_OFF" title="Permalink to this definition">¶</a></dt>
<dd><p>Possible states of the CAN controller returned from <a class="reference internal" href="#pyb.CAN.state" title="pyb.CAN.state"><code class="xref py py-meth docutils literal"><span class="pre">state()</span></code></a>.</p>
</dd></dl>

<dl class="data">
<dt id="pyb.CAN.LIST16">
<code class="descclassname">CAN.</code><code class="descname">LIST16</code><a class="headerlink" href="#pyb.CAN.LIST16" title="Permalink to this definition">¶</a></dt>
<dt id="pyb.CAN.MASK16">
<code class="descclassname">CAN.</code><code class="descname">MASK16</code><a class="headerlink" href="#pyb.CAN.MASK16" title="Permalink to this definition">¶</a></dt>
<dt id="pyb.CAN.LIST32">
<code class="descclassname">CAN.</code><code class="descname">LIST32</code><a class="headerlink" href="#pyb.CAN.LIST32" title="Permalink to this definition">¶</a></dt>
<dt id="pyb.CAN.MASK32">
<code class="descclassname">CAN.</code><code class="descname">MASK32</code><a class="headerlink" href="#pyb.CAN.MASK32" title="Permalink to this definition">¶</a></dt>
<dd><p>The operation mode of a filter used in <a class="reference internal" href="#pyb.CAN.setfilter" title="pyb.CAN.setfilter"><code class="xref py py-meth docutils literal"><span class="pre">setfilter()</span></code></a>.</p>
</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pyb.DAC.html" class="btn btn-neutral float-right" title="class DAC – digital to analog conversion" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pyb.ADC.html" class="btn btn-neutral" title="class ADC – analog to digital conversion" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014-2019, Damien P. George, Paul Sokolovsky, OpenMV LLC, and contributors.
      Last updated on 31 Mar 2019.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Ports and Versions</span>
    openmvcam (latest)
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <!--p>
    <dl>
      <dt>Ports</dt>
      
        <dd><a href="//en/latest/unix">unix</a></dd>
      
        <dd><a href="//en/latest/pyboard">pyboard</a></dd>
      
        <dd><a href="//en/latest/wipy">wipy</a></dd>
      
        <dd><a href="//en/latest/esp8266">esp8266</a></dd>
      
        <dd><a href="//en/latest/openmvcam">openmvcam</a></dd>
      
    </dl>
    <dl>
      <dt>Versions</dt>
      
        <dd><a href="//en/latest/openmvcam">latest</a></dd>
      
    </dl>
    <dl>
      <dt>Downloads</dt>
      
        <dd><a href="//en/latest/micropython-openmvcam.pdf">PDF</a></dd>
      
    </dl>
    </p-->
    <dl>
        <dt>Language</dt>
        
          <dd><a href="http://docs.openmv.io">English</a></dd>
        
          <dd><a href="http://doc.singtown.cc/openmv_zh">中文</a></dd>
        
    </dl>
    <hr/>
    <dl>
      <dt>External links</dt>
        <dd>
          <a href="https://openmv.io">openmv.io</a>
        </dd>
        <dd>
          <a href="http://forums.openmv.io">forums.openmv.io</a>
        </dd>
        <dd>
          <a href="https://github.com/openmv/openmv">github.com/openmv/openmv</a>
        </dd>
        <dd>
          <a href="http://micropython.org">micropython.org</a>
        </dd>
        <dd>
          <a href="http://forum.micropython.org">forum.micropython.org</a>
        </dd>
        <dd>
          <a href="https://github.com/micropython/micropython">github.com/micropython/micropython</a>
        </dd>
    </dl>
  </div>
</div>

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.9.4',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>